---
env:
  - name: CF_API_TOKEN
    valueFrom:
      secretKeyRef:
        name: externaldns-cloudflare-token
        key: cloudflare-token

extraArgs:
  - --cloudflare-dns-records-per-page=1000
  - --ignore-ingress-tls-spec

podAnnotations:
  secret.reloader.stakater.com/reload: externaldns-cloudflare-token

policy: sync
provider: cloudflare

resources:
  requests:
    cpu: 13m
    memory: 256M
  limits:
    memory: 256M

serviceMonitor:
  enabled: true

sources:
  - service
  - ingress

txtOwnerId: ${CLUSTER_NAME}
txtPrefix: k8s.

logLevel: debug

postRenderers:
  - kustomize:
      patches:
        - target:
            version: v1
            kind: Deployment
            name: external-dns
          patch: |
            - op: add
              path: /spec/template/spec/enableServiceLinks
              value: false
